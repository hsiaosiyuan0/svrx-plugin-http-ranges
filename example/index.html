<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <video autoplay></video>
  </body>
  <script>
    var vidElement = document.querySelector("video");

    if (window.MediaSource) {
      var mediaSource = new MediaSource();
      vidElement.src = URL.createObjectURL(mediaSource);
      mediaSource.addEventListener("sourceopen", sourceOpen);
    } else {
      console.log("The Media Source Extensions API is not supported.");
    }

    function sourceOpen(e) {
      URL.revokeObjectURL(vidElement.src);
      var mime = 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"';
      var mediaSource = e.target;
      var sourceBuffer = mediaSource.addSourceBuffer(mime);
      var videoUrl = "videos/2.mp4";
      fetch(videoUrl)
        .then(function(response) {
          return response.arrayBuffer();
        })
        .then(function(arrayBuffer) {
          sourceBuffer.addEventListener("updateend", function(e) {
            if (!sourceBuffer.updating && mediaSource.readyState === "open") {
              mediaSource.endOfStream();
            }
          });
          sourceBuffer.appendBuffer(arrayBuffer);
        });
    }
  </script>
</html>
